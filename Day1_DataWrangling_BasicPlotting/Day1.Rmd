
---
title: "Day 1 - Data Wrangling and Basic Plotting"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
library(palmerpenguins)
library(ggplot2)
```

# Session 1: Data Import and Preview

```{r}
# Import built-in datasets
data("penguins")
glimpse(penguins)

# Import CSV file
write_csv(penguins, "penguins_sample.csv")
penguins_csv <- read_csv("penguins_sample.csv")

# Import Excel file
write.xlsx(penguins, "penguins_sample.xlsx")
penguins_excel <- read_excel("penguins_sample.xlsx")
```

# Session 2: Data Cleaning and Transformation

```{r}
# Remove NA values
penguins_clean <- penguins %>%
  drop_na()

# Rename columns
penguins_clean <- penguins_clean %>%
  rename(Flipper = flipper_length_mm, Mass = body_mass_g)

# Create new variable
penguins_clean <- penguins_clean %>%
  mutate(BMI = Mass / (bill_length_mm^2))

# Summarize
penguins_summary <- penguins_clean %>%
  group_by(species) %>%
  summarise(mean_mass = mean(Mass), mean_bmi = mean(BMI))
```

# Session 3: Basic ggplot2

```{r}
# Scatter plot
ggplot(penguins_clean, aes(x = bill_length_mm, y = Mass, color = species)) +
  geom_point()

# Histogram
ggplot(penguins_clean, aes(x = Mass)) +
  geom_histogram(bins = 30, fill = "steelblue")

# Boxplot
ggplot(penguins_clean, aes(x = species, y = Mass)) +
  geom_boxplot()

# Line plot (fake time series)
penguins_clean$time <- 1:nrow(penguins_clean)
ggplot(penguins_clean, aes(x = time, y = Mass)) +
  geom_line()
```

# Session 4: Aesthetics and Layers

```{r}
# Shape, size, color
ggplot(penguins_clean, aes(x = Flipper, y = Mass, shape = species, color = island, size = bill_depth_mm)) +
  geom_point(alpha = 0.7)

# Faceting
ggplot(penguins_clean, aes(x = bill_length_mm, y = Mass)) +
  geom_point() +
  facet_wrap(~species)
```

# Exercises

```{r}
# Q1: Use `filter()` to select only Adelie penguins and create a histogram of their flipper length
adelie <- penguins %>% filter(species == "Adelie")
ggplot(adelie, aes(x = flipper_length_mm)) +
  geom_histogram(bins = 20)

# Q2: Create a grouped bar plot showing the count of penguins by island and species
ggplot(penguins, aes(x = island, fill = species)) +
  geom_bar(position = "dodge")
```

# Advanced Wrangling

```{r}
# Wide to long and back
penguins_long <- penguins %>%
  pivot_longer(cols = c(bill_length_mm, bill_depth_mm), names_to = "measure", values_to = "value")

penguins_wide <- penguins_long %>%
  pivot_wider(names_from = measure, values_from = value)

# Nesting
nested_data <- penguins %>%
  group_by(species) %>%
  nest()

# Map to summarize nested data
summarised_data <- nested_data %>%
  mutate(summary = map(data, ~ summarise(.x, avg_mass = mean(body_mass_g, na.rm = TRUE))))
```

# Final Challenge

```{r}
# Create a full EDA pipeline
penguins_clean <- penguins %>%
  drop_na() %>%
  mutate(BMI = body_mass_g / (bill_length_mm * bill_depth_mm)) %>%
  group_by(species, island) %>%
  summarise(mean_mass = mean(body_mass_g), mean_bmi = mean(BMI))

ggplot(penguins_clean, aes(x = species, y = mean_mass, fill = island)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_minimal() +
  labs(title = "Mean Mass by Species and Island")
```

# Saving Plots

```{r}
p <- ggplot(penguins, aes(x = species, y = body_mass_g, fill = species)) +
  geom_boxplot()
ggsave("penguin_plot_day1.png", plot = p, width = 6, height = 4)
```
